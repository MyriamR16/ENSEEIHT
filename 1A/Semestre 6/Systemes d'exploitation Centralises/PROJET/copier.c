#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <fcntl.h>


#define BUFSIZE 1

int main(int argc, char* argv[]) {
    char buffer[BUFSIZE];
    int src, dest;
    int lus;
    
    if (argc != 3){
        printf("Attention ! Pour cette commande il faut exactement 3 arguments !");
        exit(1);
    }
    
    //definition du fichier source
    src = open(argv[1], O_RDONLY);
    if (src == -1) {
        printf("Probleme lors de l'ouverture !");
        exit(1);
    }
    
    //definition du fichier destination
    dest = open(argv[2], O_WRONLY|O_TRUNC|O_CREAT, 0640);
    if (dest == -1) {
        printf("Probleme lors de l'ouverture !");
        exit(1);
    }
    
    while ((lus = read(src, &buffer,BUFSIZE))>0){
        if (write(dest, &buffer, BUFSIZE) != lus){
            printf("Erreur !");
            close(src);
            close(dest);
            exit(1);
        } 
    }
    close(src); 
    close(dest);
 }
